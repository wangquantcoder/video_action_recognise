This is the DP+IDT code
